{% extends "index.html" %}

{% block content %}
<div class="page-list">
    {% set pages = section.pages %}
    {% for sub in section.subsections %}
        {% set sub = get_section(path=sub) %}
        {% set_global pages = pages | concat(with=sub.pages) %}
    {% endfor %}
    {% set render_drafts = config.extra.env == "dev" %}
    {% if config.extra.env == "dev" %}
    <div style="border:1px dashed red">
        <span>DRAFTS!!!</span>
        {% for page in pages | filter(attribute="draft", value=true) %}
            <a class="post-summary draft-summary" href="{{page.path}}" >
                <h2>{{page.title}}</h2>
            </a>
            {% if page.extra.snippet %}
            <span class="summary">
                {{page.extra.snippet}}
            </span>
            {% endif %}
            {% endfor %}
        {% endif %}
    </div>
    {% for page in pages | filter(attribute="draft", value=false) %}
        {% if render_drafts or not page.draft %}
            <a class="post-summary" href={% if page.extra.extern_link %}"{{page.extra.extern_link}}"{% else %}"{{page.path}}"{% endif %}>
                <h2>{{ page.title }}</h2>
            </a>
            {% if page.extra.snippet %}
                <span class="summary">
                    {{page.extra.snippet}}
                </span>
            {% endif %}
        {% endif %}     
    {% endfor %}
</div>
{% endblock content %}
